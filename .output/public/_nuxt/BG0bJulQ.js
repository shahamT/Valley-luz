import{u as H,g as le,x as oe,S as re,j as ie,n as de,o as ce,p as ue,q as ve,y as U,l as ye,m as me,b as q,_ as he,r as _e,s as De,z as R,w as j,f as pe}from"./CS5ACRjG.js";import{o as c,c as p,e as u,t as g,f as be,a as l,b as d,F as G,r as X,j as f,g as ge,n as fe,w as B,i as $,k as I,l as K,p as Ce,m as we,q as Se,_ as xe,h as T}from"./CoydzPQz.js";import{U as L,a as O}from"./B3v3fkZ5.js";const Te={class:"KanbanEventCard-time"},Ke={class:"KanbanEventCard-content"},$e={class:"KanbanEventCard-title"},Ie={class:"KanbanEventCard-desc"},Ee=Object.assign({name:"KanbanEventCard"},{__name:"KanbanEventCard",props:{event:{type:Object,required:!0}},setup(o){const v=o,{categories:n}=H(),y=d(()=>le(v.event.mainCategory,n.value));return(b,m)=>(c(),p("div",{class:"KanbanEventCard",style:be({borderTopColor:l(y)})},[u("div",Te,g(o.event.timeText),1),u("div",Ke,[u("h3",$e,g(o.event.title),1),u("p",Ie,g(o.event.shortDescription||o.event.desc),1)])],4))}}),Pe={class:"KanbanColumn-header"},Ve={class:"KanbanColumn-title"},Ye={class:"KanbanColumn-events"},Me={key:0,class:"KanbanColumn-empty"},ke={__name:"KanbanColumn",props:{date:{type:String,required:!0},events:{type:Array,default:()=>[]},isDisabled:{type:Boolean,default:!1}},setup(o){const v=o,n=d(()=>oe(v.date));return(y,b)=>{const m=Ee;return c(),p("div",{class:fe(["KanbanColumn",{"KanbanColumn--disabled":o.isDisabled}])},[u("div",Pe,[u("h2",Ve,g(l(n)),1)]),u("div",Ye,[(c(!0),p(G,null,X(o.events,h=>(c(),f(m,{key:h.id,event:h},null,8,["event"]))),128)),o.events.length===0?(c(),p("div",Me,g(l(L).noEvents),1)):ge("",!0)])],2)}}},Ne={class:"KanbanCarousel"},qe={__name:"KanbanCarousel",props:{visibleDays:{type:Array,required:!0},eventsByDate:{type:Object,required:!0},currentDate:{type:String,required:!0},today:{type:String,required:!0},slideToDateRequest:{type:String,default:null}},emits:["date-change"],setup(o,{emit:v}){const n=o,y=v,b=K(null),m=K(null),h=K(0),C=d(()=>{const e=n.visibleDays.findIndex(t=>t===n.currentDate);return e>=0?e:5}),r=d(()=>n.visibleDays.findIndex(e=>e>=n.today)),E=e=>e<n.today,P=d(()=>r.value>=0&&h.value>r.value),V={touchStart(e){const t=r.value>=0&&e.activeIndex>r.value;e.allowSlidePrev=t,e.params.allowSlidePrev=t}},Y=e=>{m.value=e,h.value=e.activeIndex;const t=r.value>=0&&e.activeIndex>r.value;e.allowSlidePrev=t,e.params.allowSlidePrev=t},M=e=>{const t=e.activeIndex;if(n.visibleDays[t]<n.today&&r.value>=0){e.slideTo(r.value);return}const i=r.value>=0&&t>r.value;e.allowSlidePrev=i,e.params.allowSlidePrev=i},k=e=>{const t=e.activeIndex,s=n.visibleDays[t];h.value=t,s&&y("date-change",s);const i=r.value>=0&&t>r.value;e.allowSlidePrev=i,e.params.allowSlidePrev=i};return B(()=>n.currentDate,()=>{const e=m.value;if(!e)return;const t=n.visibleDays.findIndex(s=>s===n.currentDate);t>=0&&t!==e.activeIndex&&e.slideTo(t)}),B(()=>n.slideToDateRequest,e=>{if(!e||!n.visibleDays.includes(e))return;const t=m.value;if(!t)return;const s=n.visibleDays.findIndex(i=>i===e);s>=0&&s!==t.activeIndex&&t.slideTo(s)}),(e,t)=>{const s=ke;return c(),p("section",Ne,[$(l(ie),{ref_key:"swiperRef",ref:b,"slides-per-view":3,"space-between":24,"centered-slides":!0,speed:600,"allow-touch-move":!0,resistance:!0,"resistance-ratio":0,dir:"rtl","initial-slide":C.value,"allow-slide-prev":P.value,on:V,onSwiper:Y,onSlideChange:M,onSlideChangeTransitionEnd:k,class:"KanbanCarousel-swiper"},{default:I(()=>[(c(!0),p(G,null,X(o.visibleDays,i=>(c(),f(l(re),{key:i,class:"KanbanCarousel-slide"},{default:I(()=>[$(s,{date:i,events:o.eventsByDate[i]||[],"is-disabled":E(i)},null,8,["date","events","is-disabled"])]),_:2},1024))),128))]),_:1},8,["initial-slide","allow-slide-prev"])])}}},Re={class:"DailyView"},Be={class:"DailyView-header"},Le={class:"DailyView-content"},Ae={key:1,class:"DailyView-error"},je={__name:"[date]",async setup(o){let v,n;const y=Ce(),{events:b,isLoading:m,isError:h}=H(),C=de(),{getFilteredEventsByDate:r}=ce(b),{navigateToMonth:E,navigateToMonthInDailyView:P,goToPrevDay:V,goToNextDay:Y}=ue(),{initializeFromUrl:M,startUrlSync:k}=ve({syncMonth:!1});we(()=>{M(),k()}),y.params.date&&!U(y.params.date)&&([v,n]=Se(()=>T(`/daily-view/${q()}`,{replace:!0})),await v,n());const e=d(()=>{const a=y.params.date;return a&&U(a)?a:q()}),t=d(()=>{const a=R(e.value),_=a.getDate(),D=j(a.getFullYear(),a.getMonth()+1);return`יומן Valley Luz - ${_} ${D}`});ye({title:t}),me({description:"תצוגה יומית של אירועים ופעילויות ב-Valley Luz",ogTitle:t,ogDescription:"תצוגה יומית של אירועים ב-Valley Luz"});const s=d(()=>{const a=R(e.value);return{year:a.getFullYear(),month:a.getMonth()+1}});B(s,a=>{C.setCurrentDate(a)},{immediate:!0});const i=d(()=>j(s.value.year,s.value.month)),w=d(()=>{const a=R(e.value),_=[];for(let D=-O;D<=O;D++){const x=new Date(a);x.setDate(a.getDate()+D),_.push(pe(x))}return _}),A=d(()=>q()),S=K(null),N=d(()=>e.value<=A.value),z=()=>{if(N.value)return;const a=V(e.value);w.value.includes(a)?S.value=a:T(`/daily-view/${a}`)},F=()=>{const a=Y(e.value);w.value.includes(a)?S.value=a:T(`/daily-view/${a}`)},J=d(()=>r(w.value)),Q=({year:a,month:_})=>{P(a,_)},W=({year:a})=>{C.setCurrentDate({year:a,month:s.value.month})},Z=a=>{T(`/daily-view/${a}`),S.value=null},ee=()=>{E(s.value.year,s.value.month)},ae=({view:a})=>{a==="month"&&ee()};return(a,_)=>{const D=he,x=De,te=qe,ne=_e,se=xe;return c(),f(se,{"show-month-year":!1},{default:I(()=>[u("div",Re,[u("div",Be,[$(D,{"view-mode":"day","month-year":l(i),"current-date":l(s),"prev-disabled":l(N),"prev-aria-label":"Previous day","next-aria-label":"Next day",onSelectMonthYear:Q,onYearChange:W,onViewChange:ae,onPrev:z,onNext:F},null,8,["month-year","current-date","prev-disabled"])]),u("div",Le,[$(ne,{"view-mode":"day","prev-disabled":l(N),"prev-aria-label":"Previous day","next-aria-label":"Next day",onPrev:z,onNext:F},{day:I(()=>[l(m)&&!l(b)?.length?(c(),f(x,{key:0,message:l(L).loading},null,8,["message"])):l(h)?(c(),p("div",Ae,[u("p",null,g(l(L).error),1)])):(c(),f(te,{key:2,"visible-days":l(w),"events-by-date":l(J),"current-date":l(e),today:l(A),"slide-to-date-request":l(S),onDateChange:Z},null,8,["visible-days","events-by-date","current-date","today","slide-to-date-request"]))]),_:1},8,["prev-disabled"])])])]),_:1})}}};export{je as default};
